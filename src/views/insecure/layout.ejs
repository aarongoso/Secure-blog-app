<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title><%= title || 'Insecure Blog' %></title>
  </head>
  <body>
    <nav>
      <a href="/">Home</a> |
      <a href="/create">Create Post</a> |
      <a href="/register">Register</a> |
      <a href="/login">Login</a> |
      <a href="/search">Search</a> |
      <a href="/debug/db">Debug DB</a>
    </nav>
    <hr>
    <main>
      <%- body %>
    </main>

    <!-- DOM XSS demo script: it writes location.hash to the page directly -->
    <script>
      // DOM XSS vector (vulnerable): writes hash content into page without sanitisation
      const injectionTarget = document.getElementById('dom-xss-target');
      if (injectionTarget && location.hash) {
        // vulnerable: using innerHTML with unsanitised hash
        injectionTarget.innerHTML = location.hash.substring(1);
      }
    </script>
  </body>
</html>
